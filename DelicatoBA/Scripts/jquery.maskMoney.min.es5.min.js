"use strict";!function(n){n.browser||(n.browser={},n.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),n.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),n.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),n.browser.msie=/msie/.test(navigator.userAgent.toLowerCase()));var t={destroy:function(){return n(this).unbind(".maskMoney"),n.browser.msie&&(this.onpaste=null),this},mask:function(t){return this.each(function(){var r,i=n(this);return"number"==typeof t&&(i.trigger("mask"),r=n(i.val().split(/\D/)).last()[0].length,t=t.toFixed(r),i.val(t)),i.trigger("mask")})},unmasked:function(){return this.map(function(){var i,t=n(this).val()||"0",r=-1!==t.indexOf("-");return n(t.split(/\D/).reverse()).each(function(n,t){if(t)return(i=t,!1)}),t=t.replace(/\D/g,""),t=t.replace(new RegExp(i+"$"),"."+i),r&&(t="-"+t),parseFloat(t)})},init:function(t){return t=n.extend({prefix:"",suffix:"",affixesStay:!0,thousands:",",decimal:".",precision:2,allowZero:!1,allowNegative:!1},t),this.each(function(){function r(){var s,e,r,f,o,n=i.get(0),u=0,t=0;return"number"==typeof n.selectionStart&&"number"==typeof n.selectionEnd?(u=n.selectionStart,t=n.selectionEnd):(e=document.selection.createRange(),e&&e.parentElement()===n&&(f=n.value.length,s=n.value.replace(/\r\n/g,"\n"),r=n.createTextRange(),r.moveToBookmark(e.getBookmark()),o=n.createTextRange(),o.collapse(!1),r.compareEndPoints("StartToEnd",o)>-1?u=t=f:(u=-r.moveStart("character",-f),u+=s.slice(0,u).split("\n").length-1,r.compareEndPoints("EndToEnd",o)>-1?t=f:(t=-r.moveEnd("character",-f),t+=s.slice(0,t).split("\n").length-1)))),{start:u,end:t}}function v(){var t=!(i.val().length>=i.attr("maxlength")&&i.attr("maxlength")>=0),n=r(),u=n.start,f=n.end,e=n.start!==n.end&&i.val().substring(u,f).match(/\d/)?!0:!1,o="0"===i.val().substring(0,1);return t||e||o}function y(n){i.each(function(t,i){if(i.setSelectionRange)i.focus(),i.setSelectionRange(n,n);else if(i.createTextRange){var r=i.createTextRange();r.collapse(!0);r.moveEnd("character",n);r.moveStart("character",n);r.select()}})}function u(n){var i="";return n.indexOf("-")>-1&&(n=n.replace("-",""),i="-"),i+t.prefix+n+t.suffix}function s(n){var f,e,o,s=n.indexOf("-")>-1&&t.allowNegative?"-":"",r=n.replace(/[^0-9]/g,""),i=r.slice(0,r.length-t.precision);return i=i.replace(/^0*/g,""),i=i.replace(/\B(?=(\d{3})+(?!\d))/g,t.thousands),""===i&&(i="0"),f=s+i,t.precision>0&&(e=r.slice(r.length-t.precision),o=new Array(t.precision+1-e.length).join(0),f+=t.decimal+o+e),u(f)}function h(n){var t,r=i.val().length;i.val(s(i.val()));t=i.val().length;n-=r-t;y(n)}function f(){var n=i.val();i.val(s(n))}function p(){var n=i.val();return t.allowNegative?""!==n&&"-"===n.charAt(0)?n.replace("-",""):"-"+n:n}function e(n){n.preventDefault?n.preventDefault():n.returnValue=!1}function c(t){t=t||window.event;var c,o,s,l,f,u=t.which||t.charCode||t.keyCode;return void 0===u?!1:48>u||u>57?45===u?(i.val(p()),!1):43===u?(i.val(i.val().replace("-","")),!1):13===u||9===u?!0:!n.browser.mozilla||37!==u&&39!==u||0!==t.charCode?(e(t),!0):!0:v()?(e(t),c=String.fromCharCode(u),o=r(),s=o.start,l=o.end,f=i.val(),i.val(f.substring(0,s)+c+f.substring(l,f.length)),h(s+1),!1):!1}function w(n){n=n||window.event;var c,u,s,f,l,o=n.which||n.charCode||n.keyCode;return void 0===o?!1:(c=r(),u=c.start,s=c.end,8===o||46===o||63272===o?(e(n),f=i.val(),u===s&&(8===o?""===t.suffix?u-=1:(l=f.split("").reverse().join("").search(/\d/),u=f.length-l-1,s=u+1):s+=1),i.val(f.substring(0,u)+f.substring(s,f.length)),h(u),!1):9===o?!0:!0)}function b(){a=i.val();f();var n,t=i.get(0);t.createTextRange&&(n=t.createTextRange(),n.collapse(!1),n.select())}function l(){setTimeout(function(){f()},0)}function o(){var n=parseFloat("0")/Math.pow(10,t.precision);return n.toFixed(t.precision).replace(new RegExp("\\.","g"),t.decimal)}function k(r){if(n.browser.msie&&c(r),""===i.val()||i.val()===u(o()))t.allowZero?t.affixesStay?i.val(u(o())):i.val(o()):i.val("");else if(!t.affixesStay){var f=i.val().replace(t.prefix,"").replace(t.suffix,"");i.val(f)}i.val()!==a&&i.change()}function d(){var n,t=i.get(0);t.setSelectionRange?(n=i.val().length,t.setSelectionRange(n,n)):i.val(i.val())}var a,i=n(this);t=n.extend(t,i.data());i.unbind(".maskMoney");i.bind("keypress.maskMoney",c);i.bind("keydown.maskMoney",w);i.bind("blur.maskMoney",k);i.bind("focus.maskMoney",b);i.bind("click.maskMoney",d);i.bind("cut.maskMoney",l);i.bind("paste.maskMoney",l);i.bind("mask.maskMoney",f)})}};n.fn.maskMoney=function(i){return t[i]?t[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(n.error("Method "+i+" does not exist on jQuery.maskMoney"),void 0):t.init.apply(this,arguments)}}(window.jQuery||window.Zepto);